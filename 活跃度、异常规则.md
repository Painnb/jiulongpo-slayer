

## 一、异常检测规则

| 序号 | 规则名称         | 关键数据字段                                      | 检测条件/阈值                                                | 说明                     |
| ---- | ---------------- | ------------------------------------------------- | ------------------------------------------------------------ | ------------------------ |
| 1    | 速度一致性检测   | velocityGNSS、velocityCAN                         | 两者差值绝对值 ≤ 5 m/s                                       | 超出则认为数据异常       |
| 2    | 加速度范围检测   | accelerationLon、accelerationLat、accelerationVer | 每项转换后须位于区间 [-10, +10] m/s²                         | 超出范围视为异常         |
| 3    | 方向盘转角检测   | steeringAngle（转换后值 = 原始值 ÷ 10,000）       | 绝对值 < 1000°                                               | 超出上限视为异常         |
| 4    | 横摆角速度检测   | yawRate                                           | 数值应在 ±100°/s 范围内；与方向盘转角变化趋势相匹配          | 不匹配或超出范围均为异常 |
| 5    | 制动系统状态检测 | brakeFlag、brakePos、brakePressure                | 若 brakeFlag=1，则 brakePos ≥ 50 且 brakePressure ≥ 5000；若 brakeFlag=0，则 brakePos、brakePressure 接近 0 | 制动数据异常或传感错误   |
| 6    | 发动机状态检测   | engineSpeed、engineTorque                         | engineSpeed ≥ 50 rpm；如 engineSpeed < 50 rpm，则 engineTorque ≤ 500 | 发动机低转速时扭矩也应低 |
| 7    | 时间戳同步检测   | timestampGNSS、timestamp3、timestamp4             | 各时间戳间差异 ≤ 100 毫秒                                    | 时间戳不同步视为异常     |
| 8    | 经纬度变化检测   | latitude、longitude                               | 两个相邻10秒内：纬度差 ≤ 0.004°；经度差 ≤ 0.005°             | 超出范围视为数据跳变异常 |

------

## 二、活跃度检测规则

| 序号 | 规则名称           | 关键数据字段                          | 检测条件/阈值                                                | 说明                         |
| ---- | ------------------ | ------------------------------------- | ------------------------------------------------------------ | ---------------------------- |
| 1    | 消息频率检测       | 时间戳（如 timestampGNSS）、messageId | 在预设窗口（如5分钟内）至少接收 5 条消息                     | 消息数不足提示车辆可能休眠   |
| 2    | 车速状态检测       | velocityGNSS 或 velocityCAN           | 连续多条数据车速均低于 1 m/s                                 | 持续静止视为低活跃或休眠状态 |
| 3    | 发动机工作状态检测 | engineSpeed                           | 当 engineSpeed > 50 rpm 时，表明发动机在运行；连续 3 条以上 engineSpeed < 50 rpm 视为休眠状态 | 发动机数据反映车辆活跃度     |
| 4    | 驾驶模式判断       | driveMode                             | driveMode 值在合法区间（例如 1～9），非驾驶或休眠状态则活跃度低 | 驾驶状态与活跃度直接关联     |

