# 车云数据解析系统

## 项目简介

车云数据解析系统是面向“车路云一体化”智能网联仿真平台的核心子系统，专注于实时接收、解析、存储并展示车辆上传的 JSON 格式数据。系统通过 MQTT 协议订阅车辆数据消息，按照车云数据交互规范进行解析，并将解析结果写入 MySQL 数据库。前端采用 Vue3 实现实时数据展示、历史数据查询与报表统计，同时支持 Excel 数据导出、用户登录及权限管理。

## 技术架构

- **前端：** Vue 3
- **后端：** Spring Boot 3.0.2（JDK 17）
- **数据持久层：** MyBatis，MySQL 数据库
- **消息通信：** MQTT（支持 EMQX 等 Broker）
- **其他：** RESTful API、SSE（实时数据推送，可选）

## 项目背景

本系统依托车路云一体化仿真平台，实现车端（车辆）与云端数据交互。车辆上传数据（如车辆ID、时间戳、经纬度、速度、加速度等）通过 MQTT 实时传输到云端，系统解析并存储这些数据，为后续数据可视化、历史查询、统计报表等提供数据支撑。

## 核心功能

- **MQTT 数据订阅与 JSON 解析：**
  - 订阅仿真平台发布的车辆数据主题（如 `vehicle/+/data`），接收 JSON 格式消息。
  - 按照车云数据交互规范解析关键字段（车辆ID、时间戳、经纬度、速度、加速度等），进行数据校验与清洗。
- **数据存储：**
  - 将解析后的数据持久化到 MySQL 数据库。
  - 支持高并发数据写入，采用唯一索引和主键约束防止重复数据存储。
- **实时数据展示：**
  - 前端页面实时滚动展示最新车辆数据（车辆ID、时间、位置、速度等），支持 WebSocket 或轮询实现数据推送。
- **历史数据查询与 Excel 导出：**
  - 根据用户指定的时间范围、车辆ID等条件查询历史数据记录。
  - 支持将查询结果导出为 Excel 文件，方便数据离线分析和存档。
- **数据统计报表：**
  - 对车辆数据进行统计（如车辆活跃度、异常数据统计等），生成图表和数据报表供用户查看。
- **用户登录与权限管理：**
  - 实现基于角色的用户认证与权限控制（管理员与普通用户）。
  - 登录、注册、修改密码、注销以及权限校验均通过 JWT 或 Session 机制实现。

## 系统设计与模块分解

### 1. 数据接入层

- **MQTT 数据订阅模块：**
  - 配置 MQTT Broker 地址、端口、客户端ID 及认证信息。
  - 采用异步处理与重连机制保证数据稳定接收。
- **JSON 数据解析模块：**
  - 按照协议解析各字段（时间戳、车辆ID、经度、纬度、速度、航向角、档位、ABS状态等），校验数据有效性。
  - 对异常数据进行标记与日志记录。

### 2. 数据存储层

- **MySQL 数据库：**
  - 设计车辆数据表、用户表等，确保数据查询、统计的高效执行。

### 3. 应用展示层

- **前端展示：**
  - 基于 Vue3 构建单页应用，实现实时数据看板、历史查询页面、统计报表页面以及用户登录界面。
  - 支持数据图表、列表分页、Excel 导出等功能。
- **后端 API 服务：**
  - 通过 Spring Boot 提供 RESTful 接口，包括登录认证、实时数据获取、历史数据查询、数据导出、报表统计等。
  - 与前端采用 HTTP/HTTPS 或 WebSocket 进行通信。

### 4. 异常处理与日志策略

- **MQTT 模块：**
  - 断线重连、消息格式错误、数据异常值记录与日志警告。
- **数据存储：**
  - 数据库连接异常、唯一键冲突、SQL 执行异常等均有捕获、日志记录和重试机制。
- **查询与报表：**
  - 参数校验、分页限制以及针对无数据情况的友好提示。
- **登录与权限：**
  - 统一返回“用户名或密码错误”的提示，未登录或权限不足请求返回相应 HTTP 状态码（如 401、403），并记录安全日志。

## 开发与部署

### 环境要求

- **JDK：** 17
- **Spring Boot：** 3.0.2
- **前端：** Vue 3（建议使用 Vue CLI 或 Vite 构建项目）
- **数据库：** MySQL 5.7+
- **MQTT Broker：** EMQX 或其他支持 MQTT 协议的服务

### 构建与运行

1. **后端项目：**
   - 使用 Maven 进行构建：`mvn clean package`
   - 修改 `application.yml`（或 properties）文件，配置数据库、MQTT Broker、日志等参数。
   - 运行 Spring Boot 应用：`java -jar target/车云数据解析系统.jar`
2. **前端项目：**
   - 进入前端目录，安装依赖：`npm install`
   - 启动开发服务器：`npm run serve`
   - 构建发布版本：`npm run build`
3. **数据库初始化：**
   - 在 MySQL 中创建数据库并执行建表脚本（如上所示），完成数据表初始化。
4. **部署：**
   - 后端部署在支持 JDK 17 的服务器或容器中。
   - 前端可部署在静态资源服务器或与后端通过 Nginx 反向代理集成部署。
